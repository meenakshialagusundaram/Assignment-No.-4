---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Meenakshi Alagusundaram - ma2309, Sanya Bahal - sb2063"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

\[Data Source\] (<https://dataverse.unc.edu/dataset.xhtml?persistentId=doi:10.15139/S3/LW9D7D>)

# Visualization No. 1

```{r}
library(haven)
library(tidyverse)

data <- 
  read_dta("C:/Users/sanya/Documents/Assignment-No.-4/dataverse_files/replicate_rbindiaschools_state.dta")

data %>%
  filter(ac_year == 2014,
         statename == "Goa",
         engmed == 1) %>% 
  ggplot(aes(x = pc_femtch, 
             y = pcg_p60g8,
             color = as.factor(ruralsch)))+
  geom_point(na.rm = TRUE) +
  geom_smooth(method = "lm",
              se = FALSE)

data %>%
  filter(ac_year == 2014) %>% 
  mutate(poor = ifelse(povertyrate > mean(povertyrate), 1, 0)) %>%
  summarize(mean_bjp = mean(bjpvotes_pc_2014ge),
            poor = mean(poor),
            .by = statecd) %>% 
  ggplot(aes(x = reorder(statecd, mean_bjp), y = mean_bjp, fill = as.factor(poor))) +
  geom_bar(stat = "identity", 
           na.rm = TRUE) +
  theme_bw()

library(ggplot2)
library(dplyr)

#Filtering data for the year 2014 and taking mean of poverty rate and literacy rate for all states 
state_summary_2014<-data %>%
  filter(ac_year == 2014) %>%
  group_by(statecd) %>%
  summarize(mean_povertyrate = mean(povertyrate, na.rm = TRUE),
            mean_overallliteracyrate = mean(overallliteracyrate, na.rm = TRUE)) %>%
  ungroup()  

state_summary_2014$statecd <- as.factor(state_summary_2014$statecd) # Ensure statecd is treated as a factor

#Plotting effects of poverty rate on economic outcomes 
ggplot(state_summary_2014, aes(x = mean_povertyrate, y = mean_overallliteracyrate, color = statecd)) +
  geom_point(size = 3) + # Adds points for each data point
  scale_color_viridis_d(guide = guide_legend(override.aes = list(size = 5))) + # Uses a color scale for states
  labs(title = "State Socio-Economic Status vs. Education Outcomes (2014)",
       subtitle = "Mean Poverty Rate vs. Mean Overall Literacy Rate by State",
       x = "Mean Poverty Rate", y = "Mean Overall Literacy Rate",
       color = "State Code") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 12),
        legend.position = "bottom")






```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
